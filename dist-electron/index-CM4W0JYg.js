"use strict";const mt=require("./main-CaLDtkrw.js"),pi=require("events"),mi=require("./index-Bvw6SLl8.js"),Si=require("fs"),xi=require("path");function bi(p,D){for(var b=0;b<D.length;b++){const m=D[b];if(typeof m!="string"&&!Array.isArray(m)){for(const y in m)if(y!=="default"&&!(y in p)){const I=Object.getOwnPropertyDescriptor(m,y);I&&Object.defineProperty(p,y,I.get?I:{enumerable:!0,get:()=>m[y]})}}}return Object.freeze(Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}))}var Et={},gt={},Nt,re;function yi(){return re||(re=1,Nt=pi),Nt}var Pt,se;function Ei(){return se||(se=1,Pt=class{constructor(D){if(!(D>0)||(D-1&D)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(D),this.mask=D-1,this.top=0,this.btm=0,this.next=null}clear(){this.top=this.btm=0,this.next=null,this.buffer.fill(void 0)}push(D){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=D,this.top=this.top+1&this.mask,!0)}shift(){const D=this.buffer[this.btm];if(D!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,D}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}),Pt}var Lt,ae;function xe(){if(ae)return Lt;ae=1;const p=Ei();return Lt=class{constructor(b){this.hwm=b||16,this.head=new p(this.hwm),this.tail=this.head,this.length=0}clear(){this.head=this.tail,this.head.clear(),this.length=0}push(b){if(this.length++,!this.head.push(b)){const m=this.head;this.head=m.next=new p(2*this.head.buffer.length),this.head.push(b)}}shift(){this.length!==0&&this.length--;const b=this.tail.shift();if(b===void 0&&this.tail.next){const m=this.tail.next;return this.tail.next=null,this.tail=m,this.tail.shift()}return b}peek(){const b=this.tail.peek();return b===void 0&&this.tail.next?this.tail.next.peek():b}isEmpty(){return this.length===0}},Lt}var Ot,ue;function St(){if(ue)return Ot;ue=1;function p(n){return Buffer.isBuffer(n)||n instanceof Uint8Array}function D(n){return Buffer.isEncoding(n)}function b(n,a,x){return Buffer.alloc(n,a,x)}function m(n){return Buffer.allocUnsafe(n)}function y(n){return Buffer.allocUnsafeSlow(n)}function I(n,a){return Buffer.byteLength(n,a)}function S(n,a){return Buffer.compare(n,a)}function z(n,a){return Buffer.concat(n,a)}function Q(n,a,x,F,Z){return f(n).copy(a,x,F,Z)}function B(n,a){return f(n).equals(a)}function G(n,a,x,F,Z){return f(n).fill(a,x,F,Z)}function X(n,a,x){return Buffer.from(n,a,x)}function H(n,a,x,F){return f(n).includes(a,x,F)}function h(n,a,x,F){return f(n).indexOf(a,x,F)}function c(n,a,x,F){return f(n).lastIndexOf(a,x,F)}function d(n){return f(n).swap16()}function e(n){return f(n).swap32()}function u(n){return f(n).swap64()}function f(n){return Buffer.isBuffer(n)?n:Buffer.from(n.buffer,n.byteOffset,n.byteLength)}function P(n,a,x,F){return f(n).toString(a,x,F)}function V(n,a,x,F,Z){return f(n).write(a,x,F,Z)}function Y(n,a){return f(n).readDoubleBE(a)}function U(n,a){return f(n).readDoubleLE(a)}function E(n,a){return f(n).readFloatBE(a)}function k(n,a){return f(n).readFloatLE(a)}function r(n,a){return f(n).readInt32BE(a)}function i(n,a){return f(n).readInt32LE(a)}function o(n,a){return f(n).readUInt32BE(a)}function _(n,a){return f(n).readUInt32LE(a)}function R(n,a,x){return f(n).writeDoubleBE(a,x)}function L(n,a,x){return f(n).writeDoubleLE(a,x)}function v(n,a,x){return f(n).writeFloatBE(a,x)}function K(n,a,x){return f(n).writeFloatLE(a,x)}function M(n,a,x){return f(n).writeInt32BE(a,x)}function N(n,a,x){return f(n).writeInt32LE(a,x)}function g(n,a,x){return f(n).writeUInt32BE(a,x)}function O(n,a,x){return f(n).writeUInt32LE(a,x)}return Ot={isBuffer:p,isEncoding:D,alloc:b,allocUnsafe:m,allocUnsafeSlow:y,byteLength:I,compare:S,concat:z,copy:Q,equals:B,fill:G,from:X,includes:H,indexOf:h,lastIndexOf:c,swap16:d,swap32:e,swap64:u,toBuffer:f,toString:P,write:V,readDoubleBE:Y,readDoubleLE:U,readFloatBE:E,readFloatLE:k,readInt32BE:r,readInt32LE:i,readUInt32BE:o,readUInt32LE:_,writeDoubleBE:R,writeDoubleLE:L,writeFloatBE:v,writeFloatLE:K,writeInt32BE:M,writeInt32LE:N,writeUInt32BE:g,writeUInt32LE:O},Ot}var Ut,oe;function gi(){if(oe)return Ut;oe=1;const p=St();return Ut=class{constructor(b){this.encoding=b}get remaining(){return 0}decode(b){return p.toString(b,this.encoding)}flush(){return""}},Ut}var Ft,le;function wi(){if(le)return Ft;le=1;const p=St();return Ft=class{constructor(){this.codePoint=0,this.bytesSeen=0,this.bytesNeeded=0,this.lowerBoundary=128,this.upperBoundary=191}get remaining(){return this.bytesSeen}decode(b){if(this.bytesNeeded===0){let y=!0;for(let I=Math.max(0,b.byteLength-4),S=b.byteLength;I<S&&y;I++)y=b[I]<=127;if(y)return p.toString(b,"utf8")}let m="";for(let y=0,I=b.byteLength;y<I;y++){const S=b[y];if(this.bytesNeeded===0){S<=127?m+=String.fromCharCode(S):(this.bytesSeen=1,S>=194&&S<=223?(this.bytesNeeded=2,this.codePoint=S&31):S>=224&&S<=239?(S===224?this.lowerBoundary=160:S===237&&(this.upperBoundary=159),this.bytesNeeded=3,this.codePoint=S&15):S>=240&&S<=244?(S===240&&(this.lowerBoundary=144),S===244&&(this.upperBoundary=143),this.bytesNeeded=4,this.codePoint=S&7):m+="�");continue}if(S<this.lowerBoundary||S>this.upperBoundary){this.codePoint=0,this.bytesNeeded=0,this.bytesSeen=0,this.lowerBoundary=128,this.upperBoundary=191,m+="�";continue}this.lowerBoundary=128,this.upperBoundary=191,this.codePoint=this.codePoint<<6|S&63,this.bytesSeen++,this.bytesSeen===this.bytesNeeded&&(m+=String.fromCodePoint(this.codePoint),this.codePoint=0,this.bytesNeeded=0,this.bytesSeen=0)}return m}flush(){const b=this.bytesNeeded>0?"�":"";return this.codePoint=0,this.bytesNeeded=0,this.bytesSeen=0,this.lowerBoundary=128,this.upperBoundary=191,b}},Ft}var Bt,he;function ki(){if(he)return Bt;he=1;const p=gi(),D=wi();Bt=class{constructor(y="utf8"){switch(this.encoding=b(y),this.encoding){case"utf8":this.decoder=new D;break;case"utf16le":case"base64":throw new Error("Unsupported encoding: "+this.encoding);default:this.decoder=new p(this.encoding)}}get remaining(){return this.decoder.remaining}push(y){return typeof y=="string"?y:this.decoder.decode(y)}write(y){return this.push(y)}end(y){let I="";return y&&(I=this.push(y)),I+=this.decoder.flush(),I}};function b(m){switch(m=m.toLowerCase(),m){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return m;default:throw new Error("Unknown encoding: "+m)}}return Bt}var vt,fe;function be(){if(fe)return vt;fe=1;const{EventEmitter:p}=yi(),D=new Error("Stream was destroyed"),b=new Error("Premature close"),m=xe(),y=ki(),I=typeof queueMicrotask>"u"?l=>mt.commonjsGlobal.process.nextTick(l):queueMicrotask,S=(1<<29)-1,z=1,Q=2,B=4,G=8,X=S^z,H=S^Q,h=16,c=32,d=64,e=128,u=256,f=512,P=1024,V=2048,Y=4096,U=8192,E=16384,k=32768,r=65536,i=131072,o=u|f,_=h|r,R=d|h,L=Y|e,v=u|i,K=S^h,M=S^d,N=S^(d|r),g=S^r,O=S^u,n=S^(e|U),a=S^P,x=S^o,F=S^k,Z=S^c,et=S^i,ut=S^v,tt=1<<18,C=2<<18,$=4<<18,j=8<<18,rt=16<<18,st=32<<18,kt=64<<18,ht=128<<18,Tt=256<<18,ot=512<<18,xt=1024<<18,Ee=S^(tt|Tt),Ct=S^$,ge=S^(tt|ot),we=S^rt,ke=S^j,Mt=S^ht,Te=S^C,zt=S^xt,ct=h|tt,Gt=S^ct,It=E|st,it=B|G|Q,J=it|z,Ht=it|It,Ie=Ct&M,bt=ht|k,Re=bt&Gt,jt=J|Re,De=J|P|E,Vt=J|E|e,Ae=J|P|e,Ne=J|Y|e|U,Pe=J|h|P|E|r|i,Le=it|P|E,Oe=c|J|k|d,Ue=k|z,Fe=J|ot|st,Be=j|rt,Yt=j|tt,ve=j|rt|J|tt,Kt=J|tt|j|xt,We=$|tt,qe=tt|Tt,Ce=J|ot|Yt|st,Me=rt|it|ot|st,ze=C|J|ht|$,Ge=ot|st|it,yt=Symbol.asyncIterator||Symbol("asyncIterator");class Qt{constructor(t,{highWaterMark:s=16384,map:w=null,mapWritable:T,byteLength:q,byteLengthWritable:W}={}){this.stream=t,this.queue=new m,this.highWaterMark=s,this.buffered=0,this.error=null,this.pipeline=null,this.drains=null,this.byteLength=W||q||ie,this.map=T||w,this.afterWrite=Qe.bind(this),this.afterUpdateNextTick=Ze.bind(this)}get ended(){return(this.stream._duplexState&st)!==0}push(t){return(this.stream._duplexState&Ge)!==0?!1:(this.map!==null&&(t=this.map(t)),this.buffered+=this.byteLength(t),this.queue.push(t),this.buffered<this.highWaterMark?(this.stream._duplexState|=j,!0):(this.stream._duplexState|=Be,!1))}shift(){const t=this.queue.shift();return this.buffered-=this.byteLength(t),this.buffered===0&&(this.stream._duplexState&=ke),t}end(t){typeof t=="function"?this.stream.once("finish",t):t!=null&&this.push(t),this.stream._duplexState=(this.stream._duplexState|ot)&Ct}autoBatch(t,s){const w=[],T=this.stream;for(w.push(t);(T._duplexState&Kt)===Yt;)w.push(T._writableState.shift());if((T._duplexState&J)!==0)return s(null);T._writev(w,s)}update(){const t=this.stream;t._duplexState|=C;do{for(;(t._duplexState&Kt)===j;){const s=this.shift();t._duplexState|=qe,t._write(s,this.afterWrite)}(t._duplexState&We)===0&&this.updateNonPrimary()}while(this.continueUpdate()===!0);t._duplexState&=Te}updateNonPrimary(){const t=this.stream;if((t._duplexState&Ce)===ot){t._duplexState=t._duplexState|tt,t._final(Ke.bind(this));return}if((t._duplexState&it)===B){(t._duplexState&bt)===0&&(t._duplexState|=ct,t._destroy(Xt.bind(this)));return}(t._duplexState&jt)===z&&(t._duplexState=(t._duplexState|ct)&X,t._open($t.bind(this)))}continueUpdate(){return(this.stream._duplexState&ht)===0?!1:(this.stream._duplexState&=Mt,!0)}updateCallback(){(this.stream._duplexState&ze)===$?this.update():this.updateNextTick()}updateNextTick(){(this.stream._duplexState&ht)===0&&(this.stream._duplexState|=ht,(this.stream._duplexState&C)===0&&I(this.afterUpdateNextTick))}}class He{constructor(t,{highWaterMark:s=16384,map:w=null,mapReadable:T,byteLength:q,byteLengthReadable:W}={}){this.stream=t,this.queue=new m,this.highWaterMark=s===0?1:s,this.buffered=0,this.readAhead=s>0,this.error=null,this.pipeline=null,this.byteLength=W||q||ie,this.map=T||w,this.pipeTo=null,this.afterRead=Xe.bind(this),this.afterUpdateNextTick=$e.bind(this)}get ended(){return(this.stream._duplexState&E)!==0}pipe(t,s){if(this.pipeTo!==null)throw new Error("Can only pipe to one destination");if(typeof s!="function"&&(s=null),this.stream._duplexState|=f,this.pipeTo=t,this.pipeline=new Ve(this.stream,t,s),s&&this.stream.on("error",ne),_t(t))t._writableState.pipeline=this.pipeline,s&&t.on("error",ne),t.on("finish",this.pipeline.finished.bind(this.pipeline));else{const w=this.pipeline.done.bind(this.pipeline,t),T=this.pipeline.done.bind(this.pipeline,t,null);t.on("error",w),t.on("close",T),t.on("finish",this.pipeline.finished.bind(this.pipeline))}t.on("drain",Ye.bind(this)),this.stream.emit("piping",t),t.emit("pipe",this.stream)}push(t){const s=this.stream;return t===null?(this.highWaterMark=0,s._duplexState=(s._duplexState|P)&N,!1):this.map!==null&&(t=this.map(t),t===null)?(s._duplexState&=g,this.buffered<this.highWaterMark):(this.buffered+=this.byteLength(t),this.queue.push(t),s._duplexState=(s._duplexState|e)&g,this.buffered<this.highWaterMark)}shift(){const t=this.queue.shift();return this.buffered-=this.byteLength(t),this.buffered===0&&(this.stream._duplexState&=n),t}unshift(t){const s=[this.map!==null?this.map(t):t];for(;this.buffered>0;)s.push(this.shift());for(let w=0;w<s.length-1;w++){const T=s[w];this.buffered+=this.byteLength(T),this.queue.push(T)}this.push(s[s.length-1])}read(){const t=this.stream;if((t._duplexState&Vt)===e){const s=this.shift();return this.pipeTo!==null&&this.pipeTo.write(s)===!1&&(t._duplexState&=x),(t._duplexState&V)!==0&&t.emit("data",s),s}return this.readAhead===!1&&(t._duplexState|=i,this.updateNextTick()),null}drain(){const t=this.stream;for(;(t._duplexState&Vt)===e&&(t._duplexState&o)!==0;){const s=this.shift();this.pipeTo!==null&&this.pipeTo.write(s)===!1&&(t._duplexState&=x),(t._duplexState&V)!==0&&t.emit("data",s)}}update(){const t=this.stream;t._duplexState|=c;do{for(this.drain();this.buffered<this.highWaterMark&&(t._duplexState&Pe)===i;)t._duplexState|=_,t._read(this.afterRead),this.drain();(t._duplexState&Ne)===L&&(t._duplexState|=U,t.emit("readable")),(t._duplexState&R)===0&&this.updateNonPrimary()}while(this.continueUpdate()===!0);t._duplexState&=Z}updateNonPrimary(){const t=this.stream;if((t._duplexState&Ae)===P&&(t._duplexState=(t._duplexState|E)&a,t.emit("end"),(t._duplexState&Ht)===It&&(t._duplexState|=B),this.pipeTo!==null&&this.pipeTo.end()),(t._duplexState&it)===B){(t._duplexState&bt)===0&&(t._duplexState|=ct,t._destroy(Xt.bind(this)));return}(t._duplexState&jt)===z&&(t._duplexState=(t._duplexState|ct)&X,t._open($t.bind(this)))}continueUpdate(){return(this.stream._duplexState&k)===0?!1:(this.stream._duplexState&=F,!0)}updateCallback(){(this.stream._duplexState&Oe)===d?this.update():this.updateNextTick()}updateNextTickIfOpen(){(this.stream._duplexState&Ue)===0&&(this.stream._duplexState|=k,(this.stream._duplexState&c)===0&&I(this.afterUpdateNextTick))}updateNextTick(){(this.stream._duplexState&k)===0&&(this.stream._duplexState|=k,(this.stream._duplexState&c)===0&&I(this.afterUpdateNextTick))}}class je{constructor(t){this.data=null,this.afterTransform=ti.bind(t),this.afterFinal=null}}class Ve{constructor(t,s,w){this.from=t,this.to=s,this.afterPipe=w,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(t,s){if(s&&(this.error=s),t===this.to&&(this.to=null,this.from!==null)){((this.from._duplexState&E)===0||!this.pipeToFinished)&&this.from.destroy(this.error||new Error("Writable stream closed prematurely"));return}if(t===this.from&&(this.from=null,this.to!==null)){(t._duplexState&E)===0&&this.to.destroy(this.error||new Error("Readable stream closed before ending"));return}this.afterPipe!==null&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null}}function Ye(){this.stream._duplexState|=f,this.updateCallback()}function Ke(l){const t=this.stream;l&&t.destroy(l),(t._duplexState&it)===0&&(t._duplexState|=st,t.emit("finish")),(t._duplexState&Ht)===It&&(t._duplexState|=B),t._duplexState&=ge,(t._duplexState&C)===0?this.update():this.updateNextTick()}function Xt(l){const t=this.stream;!l&&this.error!==D&&(l=this.error),l&&t.emit("error",l),t._duplexState|=G,t.emit("close");const s=t._readableState,w=t._writableState;if(s!==null&&s.pipeline!==null&&s.pipeline.done(t,l),w!==null){for(;w.drains!==null&&w.drains.length>0;)w.drains.shift().resolve(!1);w.pipeline!==null&&w.pipeline.done(t,l)}}function Qe(l){const t=this.stream;l&&t.destroy(l),t._duplexState&=Ee,this.drains!==null&&Je(this.drains),(t._duplexState&ve)===rt&&(t._duplexState&=we,(t._duplexState&kt)===kt&&t.emit("drain")),this.updateCallback()}function Xe(l){l&&this.stream.destroy(l),this.stream._duplexState&=K,this.readAhead===!1&&(this.stream._duplexState&u)===0&&(this.stream._duplexState&=et),this.updateCallback()}function $e(){(this.stream._duplexState&c)===0&&(this.stream._duplexState&=F,this.update())}function Ze(){(this.stream._duplexState&C)===0&&(this.stream._duplexState&=Mt,this.update())}function Je(l){for(let t=0;t<l.length;t++)--l[t].writes===0&&(l.shift().resolve(!0),t--)}function $t(l){const t=this.stream;l&&t.destroy(l),(t._duplexState&B)===0&&((t._duplexState&De)===0&&(t._duplexState|=d),(t._duplexState&Fe)===0&&(t._duplexState|=$),t.emit("open")),t._duplexState&=Gt,t._writableState!==null&&t._writableState.updateCallback(),t._readableState!==null&&t._readableState.updateCallback()}function ti(l,t){t!=null&&this.push(t),this._writableState.afterWrite(l)}function ei(l){this._readableState!==null&&(l==="data"&&(this._duplexState|=V|v,this._readableState.updateNextTick()),l==="readable"&&(this._duplexState|=Y,this._readableState.updateNextTick())),this._writableState!==null&&l==="drain"&&(this._duplexState|=kt,this._writableState.updateNextTick())}class Rt extends p{constructor(t){super(),this._duplexState=0,this._readableState=null,this._writableState=null,t&&(t.open&&(this._open=t.open),t.destroy&&(this._destroy=t.destroy),t.predestroy&&(this._predestroy=t.predestroy),t.signal&&t.signal.addEventListener("abort",ci.bind(this))),this.on("newListener",ei)}_open(t){t(null)}_destroy(t){t(null)}_predestroy(){}get readable(){return this._readableState!==null?!0:void 0}get writable(){return this._writableState!==null?!0:void 0}get destroyed(){return(this._duplexState&G)!==0}get destroying(){return(this._duplexState&it)!==0}destroy(t){(this._duplexState&it)===0&&(t||(t=D),this._duplexState=(this._duplexState|B)&Ie,this._readableState!==null&&(this._readableState.highWaterMark=0,this._readableState.error=t),this._writableState!==null&&(this._writableState.highWaterMark=0,this._writableState.error=t),this._duplexState|=Q,this._predestroy(),this._duplexState&=H,this._readableState!==null&&this._readableState.updateNextTick(),this._writableState!==null&&this._writableState.updateNextTick())}}class dt extends Rt{constructor(t){super(t),this._duplexState|=z|st|i,this._readableState=new He(this,t),t&&(this._readableState.readAhead===!1&&(this._duplexState&=et),t.read&&(this._read=t.read),t.eagerOpen&&this._readableState.updateNextTick(),t.encoding&&this.setEncoding(t.encoding))}setEncoding(t){const s=new y(t),w=this._readableState.map||si;return this._readableState.map=T,this;function T(q){const W=s.push(q);return W===""&&(q.byteLength!==0||s.remaining>0)?null:w(W)}}_read(t){t(null)}pipe(t,s){return this._readableState.updateNextTick(),this._readableState.pipe(t,s),t}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(t){return this._readableState.updateNextTickIfOpen(),this._readableState.push(t)}unshift(t){return this._readableState.updateNextTickIfOpen(),this._readableState.unshift(t)}resume(){return this._duplexState|=v,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=this._readableState.readAhead===!1?ut:O,this}static _fromAsyncIterator(t,s){let w;const T=new dt({...s,read(W){t.next().then(q).then(W.bind(null,null)).catch(W)},predestroy(){w=t.return()},destroy(W){if(!w)return W(null);w.then(W.bind(null,null)).catch(W)}});return T;function q(W){W.done?T.push(null):T.push(W.value)}}static from(t,s){if(li(t))return t;if(t[yt])return this._fromAsyncIterator(t[yt](),s);Array.isArray(t)||(t=t===void 0?[]:[t]);let w=0;return new dt({...s,read(T){this.push(w===t.length?null:t[w++]),T(null)}})}static isBackpressured(t){return(t._duplexState&Le)!==0||t._readableState.buffered>=t._readableState.highWaterMark}static isPaused(t){return(t._duplexState&u)===0}[yt](){const t=this;let s=null,w=null,T=null;return this.on("error",A=>{s=A}),this.on("readable",q),this.on("close",W),{[yt](){return this},next(){return new Promise(function(A,nt){w=A,T=nt;const at=t.read();at!==null?ft(at):(t._duplexState&G)!==0&&ft(null)})},return(){return pt(null)},throw(A){return pt(A)}};function q(){w!==null&&ft(t.read())}function W(){w!==null&&ft(null)}function ft(A){T!==null&&(s?T(s):A===null&&(t._duplexState&E)===0?T(D):w({value:A,done:A===null}),T=w=null)}function pt(A){return t.destroy(A),new Promise((nt,at)=>{if(t._duplexState&G)return nt({value:void 0,done:!0});t.once("close",function(){A?at(A):nt({value:void 0,done:!0})})})}}}class Zt extends Rt{constructor(t){super(t),this._duplexState|=z|E,this._writableState=new Qt(this,t),t&&(t.writev&&(this._writev=t.writev),t.write&&(this._write=t.write),t.final&&(this._final=t.final),t.eagerOpen&&this._writableState.updateNextTick())}cork(){this._duplexState|=xt}uncork(){this._duplexState&=zt,this._writableState.updateNextTick()}_writev(t,s){s(null)}_write(t,s){this._writableState.autoBatch(t,s)}_final(t){t(null)}static isBackpressured(t){return(t._duplexState&Me)!==0}static drained(t){if(t.destroyed)return Promise.resolve(!1);const s=t._writableState,T=(di(t)?Math.min(1,s.queue.length):s.queue.length)+(t._duplexState&Tt?1:0);return T===0?Promise.resolve(!0):(s.drains===null&&(s.drains=[]),new Promise(q=>{s.drains.push({writes:T,resolve:q})}))}write(t){return this._writableState.updateNextTick(),this._writableState.push(t)}end(t){return this._writableState.updateNextTick(),this._writableState.end(t),this}}class Dt extends dt{constructor(t){super(t),this._duplexState=z|this._duplexState&i,this._writableState=new Qt(this,t),t&&(t.writev&&(this._writev=t.writev),t.write&&(this._write=t.write),t.final&&(this._final=t.final))}cork(){this._duplexState|=xt}uncork(){this._duplexState&=zt,this._writableState.updateNextTick()}_writev(t,s){s(null)}_write(t,s){this._writableState.autoBatch(t,s)}_final(t){t(null)}write(t){return this._writableState.updateNextTick(),this._writableState.push(t)}end(t){return this._writableState.updateNextTick(),this._writableState.end(t),this}}class Jt extends Dt{constructor(t){super(t),this._transformState=new je(this),t&&(t.transform&&(this._transform=t.transform),t.flush&&(this._flush=t.flush))}_write(t,s){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=t:this._transform(t,this._transformState.afterTransform)}_read(t){if(this._transformState.data!==null){const s=this._transformState.data;this._transformState.data=null,t(null),this._transform(s,this._transformState.afterTransform)}else t(null)}destroy(t){super.destroy(t),this._transformState.data!==null&&(this._transformState.data=null,this._transformState.afterTransform())}_transform(t,s){s(null,t)}_flush(t){t(null)}_final(t){this._transformState.afterFinal=t,this._flush(ni.bind(this))}}class ii extends Jt{}function ni(l,t){const s=this._transformState.afterFinal;if(l)return s(l);t!=null&&this.push(t),this.push(null),s(null)}function ri(...l){return new Promise((t,s)=>te(...l,w=>{if(w)return s(w);t()}))}function te(l,...t){const s=Array.isArray(l)?[...l,...t]:[l,...t],w=s.length&&typeof s[s.length-1]=="function"?s.pop():null;if(s.length<2)throw new Error("Pipeline requires at least 2 streams");let T=s[0],q=null,W=null;for(let A=1;A<s.length;A++)q=s[A],_t(T)?T.pipe(q,pt):(ft(T,!0,A>1,pt),T.pipe(q)),T=q;if(w){let A=!1;const nt=_t(q)||!!(q._writableState&&q._writableState.autoDestroy);q.on("error",at=>{W===null&&(W=at)}),q.on("finish",()=>{A=!0,nt||w(W)}),nt&&q.on("close",()=>w(W||(A?null:b)))}return q;function ft(A,nt,at,At){A.on("error",At),A.on("close",_i);function _i(){if(A._readableState&&!A._readableState.ended||at&&A._writableState&&!A._writableState.ended)return At(b)}}function pt(A){if(!(!A||W)){W=A;for(const nt of s)nt.destroy(A)}}}function si(l){return l}function ee(l){return!!l._readableState||!!l._writableState}function _t(l){return typeof l._duplexState=="number"&&ee(l)}function ai(l){return!!l._readableState&&l._readableState.ended}function ui(l){return!!l._writableState&&l._writableState.ended}function oi(l,t={}){const s=l._readableState&&l._readableState.error||l._writableState&&l._writableState.error;return!t.all&&s===D?null:s}function li(l){return _t(l)&&l.readable}function hi(l){return(l._duplexState&z)!==z||(l._duplexState&bt)!==0}function fi(l){return typeof l=="object"&&l!==null&&typeof l.byteLength=="number"}function ie(l){return fi(l)?l.byteLength:1024}function ne(){}function ci(){this.destroy(new Error("Stream aborted."))}function di(l){return l._writev!==Zt.prototype._writev&&l._writev!==Dt.prototype._writev}return vt={pipeline:te,pipelinePromise:ri,isStream:ee,isStreamx:_t,isEnded:ai,isFinished:ui,isDisturbed:hi,getStreamError:oi,Stream:Rt,Writable:Zt,Readable:dt,Duplex:Dt,Transform:Jt,PassThrough:ii},vt}var lt={},ce;function ye(){if(ce)return lt;ce=1;const p=St(),D="0000000000000000000",b="7777777777777777777",m=48,y=p.from([117,115,116,97,114,0]),I=p.from([m,m]),S=p.from([117,115,116,97,114,32]),z=p.from([32,0]),Q=4095,B=257,G=263;lt.decodeLongPath=function(i,o){return E(i,0,i.length,o)},lt.encodePax=function(i){let o="";i.name&&(o+=k(" path="+i.name+`
`)),i.linkname&&(o+=k(" linkpath="+i.linkname+`
`));const _=i.pax;if(_)for(const R in _)o+=k(" "+R+"="+_[R]+`
`);return p.from(o)},lt.decodePax=function(i){const o={};for(;i.length;){let _=0;for(;_<i.length&&i[_]!==32;)_++;const R=parseInt(p.toString(i.subarray(0,_)),10);if(!R)return o;const L=p.toString(i.subarray(_+1,R-1)),v=L.indexOf("=");if(v===-1)return o;o[L.slice(0,v)]=L.slice(v+1),i=i.subarray(R)}return o},lt.encode=function(i){const o=p.alloc(512);let _=i.name,R="";if(i.typeflag===5&&_[_.length-1]!=="/"&&(_+="/"),p.byteLength(_)!==_.length)return null;for(;p.byteLength(_)>100;){const L=_.indexOf("/");if(L===-1)return null;R+=R?"/"+_.slice(0,L):_.slice(0,L),_=_.slice(L+1)}return p.byteLength(_)>100||p.byteLength(R)>155||i.linkname&&p.byteLength(i.linkname)>100?null:(p.write(o,_),p.write(o,f(i.mode&Q,6),100),p.write(o,f(i.uid,6),108),p.write(o,f(i.gid,6),116),V(i.size,o,124),p.write(o,f(i.mtime.getTime()/1e3|0,11),136),o[156]=m+d(i.type),i.linkname&&p.write(o,i.linkname,157),p.copy(y,o,B),p.copy(I,o,G),i.uname&&p.write(o,i.uname,265),i.gname&&p.write(o,i.gname,297),p.write(o,f(i.devmajor||0,6),329),p.write(o,f(i.devminor||0,6),337),R&&p.write(o,R,345),p.write(o,f(u(o),6),148),o)},lt.decode=function(i,o,_){let R=i[156]===0?0:i[156]-m,L=E(i,0,100,o);const v=U(i,100,8),K=U(i,108,8),M=U(i,116,8),N=U(i,124,12),g=U(i,136,12),O=c(R),n=i[157]===0?null:E(i,157,100,o),a=E(i,265,32),x=E(i,297,32),F=U(i,329,8),Z=U(i,337,8),et=u(i);if(et===256)return null;if(et!==U(i,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(X(i))i[345]&&(L=E(i,345,155,o)+"/"+L);else if(!H(i)){if(!_)throw new Error("Invalid tar header: unknown format.")}return R===0&&L&&L[L.length-1]==="/"&&(R=5),{name:L,mode:v,uid:K,gid:M,size:N,mtime:new Date(1e3*g),type:O,linkname:n,uname:a,gname:x,devmajor:F,devminor:Z,pax:null}};function X(r){return p.equals(y,r.subarray(B,B+6))}function H(r){return p.equals(S,r.subarray(B,B+6))&&p.equals(z,r.subarray(G,G+2))}function h(r,i,o){return typeof r!="number"?o:(r=~~r,r>=i?i:r>=0||(r+=i,r>=0)?r:0)}function c(r){switch(r){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null}function d(r){switch(r){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0}function e(r,i,o,_){for(;o<_;o++)if(r[o]===i)return o;return _}function u(r){let i=256;for(let o=0;o<148;o++)i+=r[o];for(let o=156;o<512;o++)i+=r[o];return i}function f(r,i){return r=r.toString(8),r.length>i?b.slice(0,i)+" ":D.slice(0,i-r.length)+r+" "}function P(r,i,o){i[o]=128;for(let _=11;_>0;_--)i[o+_]=r&255,r=Math.floor(r/256)}function V(r,i,o){r.toString(8).length>11?P(r,i,o):p.write(i,f(r,11),o)}function Y(r){let i;if(r[0]===128)i=!0;else if(r[0]===255)i=!1;else return null;const o=[];let _;for(_=r.length-1;_>0;_--){const v=r[_];i?o.push(v):o.push(255-v)}let R=0;const L=o.length;for(_=0;_<L;_++)R+=o[_]*Math.pow(256,_);return i?R:-1*R}function U(r,i,o){if(r=r.subarray(i,i+o),i=0,r[i]&128)return Y(r);{for(;i<r.length&&r[i]===32;)i++;const _=h(e(r,32,i,r.length),r.length,r.length);for(;i<_&&r[i]===0;)i++;return _===i?0:parseInt(p.toString(r.subarray(i,_)),8)}}function E(r,i,o,_){return p.toString(r.subarray(i,e(r,0,i,i+o)),_)}function k(r){const i=p.byteLength(r);let o=Math.floor(Math.log(i)/Math.log(10))+1;return i+o>=Math.pow(10,o)&&o++,i+o+r}return lt}var Wt,de;function Ti(){if(de)return Wt;de=1;const{Writable:p,Readable:D,getStreamError:b}=be(),m=xe(),y=St(),I=ye(),S=y.alloc(0);class z{constructor(){this.buffered=0,this.shifted=0,this.queue=new m,this._offset=0}push(h){this.buffered+=h.byteLength,this.queue.push(h)}shiftFirst(h){return this._buffered===0?null:this._next(h)}shift(h){if(h>this.buffered)return null;if(h===0)return S;let c=this._next(h);if(h===c.byteLength)return c;const d=[c];for(;(h-=c.byteLength)>0;)c=this._next(h),d.push(c);return y.concat(d)}_next(h){const c=this.queue.peek(),d=c.byteLength-this._offset;if(h>=d){const e=this._offset?c.subarray(this._offset,c.byteLength):c;return this.queue.shift(),this._offset=0,this.buffered-=d,this.shifted+=d,e}return this.buffered-=h,this.shifted+=h,c.subarray(this._offset,this._offset+=h)}}class Q extends D{constructor(h,c,d){super(),this.header=c,this.offset=d,this._parent=h}_read(h){this.header.size===0&&this.push(null),this._parent._stream===this&&this._parent._update(),h(null)}_predestroy(){this._parent.destroy(b(this))}_detach(){this._parent._stream===this&&(this._parent._stream=null,this._parent._missing=X(this.header.size),this._parent._update())}_destroy(h){this._detach(),h(null)}}class B extends p{constructor(h){super(h),h||(h={}),this._buffer=new z,this._offset=0,this._header=null,this._stream=null,this._missing=0,this._longHeader=!1,this._callback=G,this._locked=!1,this._finished=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null,this._filenameEncoding=h.filenameEncoding||"utf-8",this._allowUnknownFormat=!!h.allowUnknownFormat,this._unlockBound=this._unlock.bind(this)}_unlock(h){if(this._locked=!1,h){this.destroy(h),this._continueWrite(h);return}this._update()}_consumeHeader(){if(this._locked)return!1;this._offset=this._buffer.shifted;try{this._header=I.decode(this._buffer.shift(512),this._filenameEncoding,this._allowUnknownFormat)}catch(h){return this._continueWrite(h),!1}if(!this._header)return!0;switch(this._header.type){case"gnu-long-path":case"gnu-long-link-path":case"pax-global-header":case"pax-header":return this._longHeader=!0,this._missing=this._header.size,!0}return this._locked=!0,this._applyLongHeaders(),this._header.size===0||this._header.type==="directory"?(this.emit("entry",this._header,this._createStream(),this._unlockBound),!0):(this._stream=this._createStream(),this._missing=this._header.size,this.emit("entry",this._header,this._stream,this._unlockBound),!0)}_applyLongHeaders(){this._gnuLongPath&&(this._header.name=this._gnuLongPath,this._gnuLongPath=null),this._gnuLongLinkPath&&(this._header.linkname=this._gnuLongLinkPath,this._gnuLongLinkPath=null),this._pax&&(this._pax.path&&(this._header.name=this._pax.path),this._pax.linkpath&&(this._header.linkname=this._pax.linkpath),this._pax.size&&(this._header.size=parseInt(this._pax.size,10)),this._header.pax=this._pax,this._pax=null)}_decodeLongHeader(h){switch(this._header.type){case"gnu-long-path":this._gnuLongPath=I.decodeLongPath(h,this._filenameEncoding);break;case"gnu-long-link-path":this._gnuLongLinkPath=I.decodeLongPath(h,this._filenameEncoding);break;case"pax-global-header":this._paxGlobal=I.decodePax(h);break;case"pax-header":this._pax=this._paxGlobal===null?I.decodePax(h):Object.assign({},this._paxGlobal,I.decodePax(h));break}}_consumeLongHeader(){this._longHeader=!1,this._missing=X(this._header.size);const h=this._buffer.shift(this._header.size);try{this._decodeLongHeader(h)}catch(c){return this._continueWrite(c),!1}return!0}_consumeStream(){const h=this._buffer.shiftFirst(this._missing);if(h===null)return!1;this._missing-=h.byteLength;const c=this._stream.push(h);return this._missing===0?(this._stream.push(null),c&&this._stream._detach(),c&&this._locked===!1):c}_createStream(){return new Q(this,this._header,this._offset)}_update(){for(;this._buffer.buffered>0&&!this.destroying;){if(this._missing>0){if(this._stream!==null){if(this._consumeStream()===!1)return;continue}if(this._longHeader===!0){if(this._missing>this._buffer.buffered)break;if(this._consumeLongHeader()===!1)return!1;continue}const h=this._buffer.shiftFirst(this._missing);h!==null&&(this._missing-=h.byteLength);continue}if(this._buffer.buffered<512)break;if(this._stream!==null||this._consumeHeader()===!1)return}this._continueWrite(null)}_continueWrite(h){const c=this._callback;this._callback=G,c(h)}_write(h,c){this._callback=c,this._buffer.push(h),this._update()}_final(h){this._finished=this._missing===0&&this._buffer.buffered===0,h(this._finished?null:new Error("Unexpected end of data"))}_predestroy(){this._continueWrite(null)}_destroy(h){this._stream&&this._stream.destroy(b(this)),h(null)}[Symbol.asyncIterator](){let h=null,c=null,d=null,e=null,u=null;const f=this;return this.on("entry",Y),this.on("error",k=>{h=k}),this.on("close",U),{[Symbol.asyncIterator](){return this},next(){return new Promise(V)},return(){return E(null)},throw(k){return E(k)}};function P(k){if(!u)return;const r=u;u=null,r(k)}function V(k,r){if(h)return r(h);if(e){k({value:e,done:!1}),e=null;return}c=k,d=r,P(null),f._finished&&c&&(c({value:void 0,done:!0}),c=d=null)}function Y(k,r,i){u=i,r.on("error",G),c?(c({value:r,done:!1}),c=d=null):e=r}function U(){P(h),c&&(h?d(h):c({value:void 0,done:!0}),c=d=null)}function E(k){return f.destroy(k),P(k),new Promise((r,i)=>{if(f.destroyed)return r({value:void 0,done:!0});f.once("close",function(){k?i(k):r({value:void 0,done:!0})})})}}}Wt=function(h){return new B(h)};function G(){}function X(H){return H&=511,H&&512-H}return Wt}var wt={exports:{}},_e;function Ii(){if(_e)return wt.exports;_e=1;const p={S_IFMT:61440,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960};try{wt.exports=require("fs").constants||p}catch{wt.exports=p}return wt.exports}var qt,pe;function Ri(){if(pe)return qt;pe=1;const{Readable:p,Writable:D,getStreamError:b}=be(),m=St(),y=Ii(),I=ye(),S=493,z=420,Q=m.alloc(1024);class B extends D{constructor(e,u,f){super({mapWritable:c,eagerOpen:!0}),this.written=0,this.header=u,this._callback=f,this._linkname=null,this._isLinkname=u.type==="symlink"&&!u.linkname,this._isVoid=u.type!=="file"&&u.type!=="contiguous-file",this._finished=!1,this._pack=e,this._openCallback=null,this._pack._stream===null?this._pack._stream=this:this._pack._pending.push(this)}_open(e){this._openCallback=e,this._pack._stream===this&&this._continueOpen()}_continuePack(e){if(this._callback===null)return;const u=this._callback;this._callback=null,u(e)}_continueOpen(){this._pack._stream===null&&(this._pack._stream=this);const e=this._openCallback;if(this._openCallback=null,e!==null){if(this._pack.destroying)return e(new Error("pack stream destroyed"));if(this._pack._finalized)return e(new Error("pack stream is already finalized"));this._pack._stream=this,this._isLinkname||this._pack._encode(this.header),this._isVoid&&(this._finish(),this._continuePack(null)),e(null)}}_write(e,u){if(this._isLinkname)return this._linkname=this._linkname?m.concat([this._linkname,e]):e,u(null);if(this._isVoid)return e.byteLength>0?u(new Error("No body allowed for this entry")):u();if(this.written+=e.byteLength,this._pack.push(e))return u();this._pack._drain=u}_finish(){this._finished||(this._finished=!0,this._isLinkname&&(this.header.linkname=this._linkname?m.toString(this._linkname,"utf-8"):"",this._pack._encode(this.header)),h(this._pack,this.header.size),this._pack._done(this))}_final(e){if(this.written!==this.header.size)return e(new Error("Size mismatch"));this._finish(),e(null)}_getError(){return b(this)||new Error("tar entry destroyed")}_predestroy(){this._pack.destroy(this._getError())}_destroy(e){this._pack._done(this),this._continuePack(this._finished?null:this._getError()),e()}}class G extends p{constructor(e){super(e),this._drain=H,this._finalized=!1,this._finalizing=!1,this._pending=[],this._stream=null}entry(e,u,f){if(this._finalized||this.destroying)throw new Error("already finalized or destroyed");typeof u=="function"&&(f=u,u=null),f||(f=H),(!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=X(e.mode)),e.mode||(e.mode=e.type==="directory"?S:z),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof u=="string"&&(u=m.from(u));const P=new B(this,e,f);return m.isBuffer(u)?(e.size=u.byteLength,P.write(u),P.end(),P):(P._isVoid,P)}finalize(){if(this._stream||this._pending.length>0){this._finalizing=!0;return}this._finalized||(this._finalized=!0,this.push(Q),this.push(null))}_done(e){e===this._stream&&(this._stream=null,this._finalizing&&this.finalize(),this._pending.length&&this._pending.shift()._continueOpen())}_encode(e){if(!e.pax){const u=I.encode(e);if(u){this.push(u);return}}this._encodePax(e)}_encodePax(e){const u=I.encodePax({name:e.name,linkname:e.linkname,pax:e.pax}),f={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:u.byteLength,mtime:e.mtime,type:"pax-header",linkname:e.linkname&&"PaxHeader",uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};this.push(I.encode(f)),this.push(u),h(this,u.byteLength),f.size=e.size,f.type=e.type,this.push(I.encode(f))}_doDrain(){const e=this._drain;this._drain=H,e()}_predestroy(){const e=b(this);for(this._stream&&this._stream.destroy(e);this._pending.length;){const u=this._pending.shift();u.destroy(e),u._continueOpen()}this._doDrain()}_read(e){this._doDrain(),e()}}qt=function(e){return new G(e)};function X(d){switch(d&y.S_IFMT){case y.S_IFBLK:return"block-device";case y.S_IFCHR:return"character-device";case y.S_IFDIR:return"directory";case y.S_IFIFO:return"fifo";case y.S_IFLNK:return"symlink"}return"file"}function H(){}function h(d,e){e&=511,e&&d.push(Q.subarray(0,512-e))}function c(d){return m.isBuffer(d)?d:m.from(d)}return qt}var me;function Di(){return me||(me=1,gt.extract=Ti(),gt.pack=Ri()),gt}var Se;function Ai(){if(Se)return Et;Se=1;const p=Di(),D=mi.requirePump(),b=Si,m=xi,y=(mt.commonjsGlobal.Bare?mt.commonjsGlobal.Bare.platform:process.platform)==="win32";Et.pack=function(d,e){d||(d="."),e||(e={});const u=e.fs||b,f=e.ignore||e.filter||B,P=e.mapStream||G,V=H(u,e.dereference?u.stat:u.lstat,d,f,e.entries,e.sort),Y=e.strict!==!1,U=typeof e.umask=="number"?~e.umask:~z(),E=e.pack||p.pack(),k=e.finish||B;let r=e.map||B,i=typeof e.dmode=="number"?e.dmode:0,o=typeof e.fmode=="number"?e.fmode:0;e.strip&&(r=h(r,e.strip)),e.readable&&(i|=parseInt(555,8),o|=parseInt(444,8)),e.writable&&(i|=parseInt(333,8),o|=parseInt(222,8)),L();function _(v,K){u.readlink(m.join(d,v),function(M,N){if(M)return E.destroy(M);K.linkname=X(N),E.entry(K,L)})}function R(v,K,M){if(E.destroyed)return;if(v)return E.destroy(v);if(!K)return e.finalize!==!1&&E.finalize(),k(E);if(M.isSocket())return L();let N={name:X(K),mode:(M.mode|(M.isDirectory()?i:o))&U,mtime:M.mtime,size:M.size,type:"file",uid:M.uid,gid:M.gid};if(M.isDirectory())return N.size=0,N.type="directory",N=r(N)||N,E.entry(N,L);if(M.isSymbolicLink())return N.size=0,N.type="symlink",N=r(N)||N,_(K,N);if(N=r(N)||N,!M.isFile())return Y?E.destroy(new Error("unsupported type for "+K)):L();const g=E.entry(N,L),O=P(u.createReadStream(m.join(d,K),{start:0,end:N.size>0?N.size-1:N.size}),N);O.on("error",function(n){g.destroy(n)}),D(O,g)}function L(v){if(v)return E.destroy(v);V(R)}return E};function I(c){return c.length?c[c.length-1]:null}function S(){return!mt.commonjsGlobal.Bare&&process.getuid?process.getuid():-1}function z(){return!mt.commonjsGlobal.Bare&&process.umask?process.umask():0}Et.extract=function(d,e){d||(d="."),e||(e={}),d=m.resolve(d);const u=e.fs||b,f=e.ignore||e.filter||B,P=e.mapStream||G,V=e.chown!==!1&&!y&&S()===0,Y=e.extract||p.extract(),U=[],E=new Date,k=typeof e.umask=="number"?~e.umask:~z(),r=e.strict!==!1,i=e.validateSymlinks!==!1;let o=e.map||B,_=typeof e.dmode=="number"?e.dmode:0,R=typeof e.fmode=="number"?e.fmode:0;return e.strip&&(o=h(o,e.strip)),e.readable&&(_|=parseInt(555,8),R|=parseInt(444,8)),e.writable&&(_|=parseInt(333,8),R|=parseInt(222,8)),Y.on("entry",L),e.finish&&Y.on("finish",e.finish),Y;function L(g,O,n){g=o(g)||g,g.name=X(g.name);const a=m.join(d,m.join("/",g.name));if(f(a,g))return O.resume(),n();const x=m.join(a,".")===m.join(d,".")?d:m.dirname(a);Q(u,x,m.join(d,"."),function(C,$){if(C)return n(C);if(!$)return n(new Error(x+" is not a valid path"));if(g.type==="directory")return U.push([a,g.mtime]),N(a,{uid:g.uid,gid:g.gid,mode:g.mode},F);N(x,{uid:g.uid,gid:g.gid,mode:493},function(j){if(j)return n(j);switch(g.type){case"file":return tt();case"link":return et();case"symlink":return Z()}if(r)return n(new Error("unsupported type for "+a+" ("+g.type+")"));O.resume(),n()})});function F(C){if(C)return n(C);K(a,g,function($){if($)return n($);if(y)return n();M(a,g,n)})}function Z(){if(y)return n();u.unlink(a,function(){const C=m.resolve(m.dirname(a),g.linkname);if(!ut(C)&&i)return n(new Error(a+" is not a valid symlink"));u.symlink(g.linkname,a,F)})}function et(){if(y)return n();u.unlink(a,function(){const C=m.join(d,m.join("/",g.linkname));b.realpath(C,function($,j){if($||!ut(j))return n(new Error(a+" is not a valid hardlink"));u.link(j,a,function(rt){if(rt&&rt.code==="EPERM"&&e.hardlinkAsFilesFallback)return O=u.createReadStream(j),tt();F(rt)})})})}function ut(C){return C===d||C.startsWith(d+m.sep)}function tt(){const C=u.createWriteStream(a),$=P(O,g);C.on("error",function(j){$.destroy(j)}),D($,C,function(j){if(j)return n(j);C.on("close",F)})}}function v(g,O){let n;for(;(n=I(U))&&g.slice(0,n[0].length)!==n[0];)U.pop();if(!n)return O();u.utimes(n[0],E,n[1],O)}function K(g,O,n){if(e.utimes===!1)return n();if(O.type==="directory")return u.utimes(g,E,O.mtime,n);if(O.type==="symlink")return v(g,n);u.utimes(g,E,O.mtime,function(a){if(a)return n(a);v(g,n)})}function M(g,O,n){const a=O.type==="symlink",x=a?u.lchmod:u.chmod,F=a?u.lchown:u.chown;if(!x)return n();const Z=(O.mode|(O.type==="directory"?_:R))&k;F&&V?F.call(u,g,O.uid,O.gid,et):et(null);function et(ut){if(ut)return n(ut);if(!x)return n();x.call(u,g,Z,n)}}function N(g,O,n){u.stat(g,function(a){if(!a)return n(null);if(a.code!=="ENOENT")return n(a);u.mkdir(g,{mode:O.mode,recursive:!0},function(x,F){if(x)return n(x);M(g,O,n)})})}};function Q(c,d,e,u){if(d===e)return u(null,!0);c.lstat(d,function(f,P){if(f&&f.code!=="ENOENT"&&f.code!=="EPERM")return u(f);if(f||P.isDirectory())return Q(c,m.join(d,".."),e,u);u(null,!1)})}function B(){}function G(c){return c}function X(c){return y?c.replace(/\\/g,"/").replace(/[:?<>|]/g,"_"):c}function H(c,d,e,u,f,P){f||(f=["."]);const V=f.slice(0);return function(U){if(!V.length)return U(null);const E=V.shift(),k=m.join(e,E);d.call(c,k,function(r,i){if(r)return U(f.indexOf(E)===-1&&r.code==="ENOENT"?null:r);if(!i.isDirectory())return U(null,E,i);c.readdir(k,function(o,_){if(o)return U(o);P&&_.sort();for(let R=0;R<_.length;R++)u(m.join(e,E,_[R]))||V.push(m.join(E,_[R]));U(null,E,i)})})}}function h(c,d){return function(e){e.name=e.name.split("/").slice(d).join("/");const u=e.linkname;return u&&(e.type==="link"||m.isAbsolute(u))&&(e.linkname=u.split("/").slice(d).join("/")),c(e)}}return Et}var Ni=Ai();const Pi=bi({__proto__:null},[Ni]);exports.index=Pi;
